"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3488],{772:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>i,contentTitle:()=>r,default:()=>m,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"implementacao_tecnica/back_end","title":"Planejamento Backend","description":"Introdu\xe7\xe3o","source":"@site/docs/implementacao_tecnica/back_end.md","sourceDirName":"implementacao_tecnica","slug":"/implementacao_tecnica/back_end","permalink":"/Hackathon-Peerseed/implementacao_tecnica/back_end","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/implementacao_tecnica/back_end.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Planejamento Backend"},"sidebar":"tutorialSidebar","previous":{"title":"Arquitetura de Dados","permalink":"/Hackathon-Peerseed/implementacao_tecnica/banco_de_dados"},"next":{"title":"Frontend","permalink":"/Hackathon-Peerseed/implementacao_tecnica/front_end"}}');var d=o(4848),n=o(8453);const t={sidebar_position:1,title:"Planejamento Backend"},r=void 0,i={},c=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",level:2},{value:"Stack Tecnol\xf3gica Principal",id:"stack-tecnol\xf3gica-principal",level:2},{value:"Detalhamento dos Componentes da Stack",id:"detalhamento-dos-componentes-da-stack",level:2},{value:"Framework de API: FastAPI",id:"framework-de-api-fastapi",level:3},{value:"Intera\xe7\xe3o com Banco de Dados: SQLAlchemy",id:"intera\xe7\xe3o-com-banco-de-dados-sqlalchemy",level:3},{value:"alida\xe7\xe3o de Dados: Pydantic",id:"alida\xe7\xe3o-de-dados-pydantic",level:3},{value:"Migra\xe7\xf5es de Banco de Dados: Alembic",id:"migra\xe7\xf5es-de-banco-de-dados-alembic",level:3},{value:"Autentica\xe7\xe3o e Autoriza\xe7\xe3o: JWT (OAuth2)",id:"autentica\xe7\xe3o-e-autoriza\xe7\xe3o-jwt-oauth2",level:3},{value:"Gerenciamento de Depend\xeancias: Poetry",id:"gerenciamento-de-depend\xeancias-poetry",level:3},{value:"Testes: Pytest",id:"testes-pytest",level:3},{value:"Estrutura de Diret\xf3rios Padr\xe3o",id:"estrutura-de-diret\xf3rios-padr\xe3o",level:2},{value:"Padr\xf5es de Comunica\xe7\xe3o entre Servi\xe7os",id:"padr\xf5es-de-comunica\xe7\xe3o-entre-servi\xe7os",level:2},{value:"Comunica\xe7\xe3o S\xedncrona (RESTful APIs)",id:"comunica\xe7\xe3o-s\xedncrona-restful-apis",level:3},{value:"Comunica\xe7\xe3o Ass\xedncrona (Orientada a Eventos)",id:"comunica\xe7\xe3o-ass\xedncrona-orientada-a-eventos",level:3}];function l(e){const a={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.h2,{id:"introdu\xe7\xe3o",children:"Introdu\xe7\xe3o"}),"\n",(0,d.jsx)(a.p,{children:"\u2003 A arquitetura de backend do Peerseed \xe9 baseada em um conjunto de microsservi\xe7os independentes, escritos em Python. A escolha por esta abordagem visa garantir alta escalabilidade, resili\xeancia e manutenibilidade, permitindo que equipes possam desenvolver, implantar e escalar cada dom\xednio de neg\xf3cio de forma aut\xf4noma."}),"\n",(0,d.jsx)(a.p,{children:"\u2003 Este documento estabelece a stack tecnol\xf3gica padr\xe3o, a estrutura de diret\xf3rios e os padr\xf5es de comunica\xe7\xe3o que devem ser seguidos por todos os servi\xe7os de backend, a fim de manter a coes\xe3o e a qualidade t\xe9cnica em todo o ecossistema."}),"\n",(0,d.jsx)(a.h2,{id:"stack-tecnol\xf3gica-principal",children:"Stack Tecnol\xf3gica Principal"}),"\n",(0,d.jsx)(a.p,{children:"\u2003Para garantir consist\xeancia e produtividade, todos os servi\xe7os de backend do Peerseed devem ser constru\xeddos utilizando a seguinte stack de tecnologias:"}),"\n",(0,d.jsxs)(a.table,{children:[(0,d.jsx)(a.thead,{children:(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.th,{children:"Componente"}),(0,d.jsx)(a.th,{children:"Tecnologia/Padr\xe3o Recomendado"}),(0,d.jsx)(a.th,{children:"Principal Vantagem"})]})}),(0,d.jsxs)(a.tbody,{children:[(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Framework API"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://fastapi.tiangolo.com/pt/",children:"FastAPI"})}),(0,d.jsx)(a.td,{children:"Performance, async nativo, docs e valida\xe7\xe3o autom\xe1ticas"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"ORM (DB)"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://www.sqlalchemy.org/",children:"SQLAlchemy 2.0+"})}),(0,d.jsx)(a.td,{children:"Padr\xe3o de mercado, produtivo e com suporte async"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Migra\xe7\xf5es de Schema"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://alembic.sqlalchemy.org/en/latest/",children:"Alembic"})}),(0,d.jsx)(a.td,{children:"Versionamento seguro do banco de dados"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Valida\xe7\xe3o/Serializa\xe7\xe3o"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://docs.pydantic.dev/latest/",children:"Pydantic"})}),(0,d.jsx)(a.td,{children:"Integrado ao FastAPI, garante a integridade dos dados"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Autentica\xe7\xe3o"}),(0,d.jsx)(a.td,{children:"JWT com OAuth2"}),(0,d.jsx)(a.td,{children:"Padr\xe3o stateless e seguro para microsservi\xe7os"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Depend\xeancias"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://python-poetry.org/docs/",children:"Poetry"})}),(0,d.jsx)(a.td,{children:"Gerenciamento moderno e builds repet\xedveis"})]}),(0,d.jsxs)(a.tr,{children:[(0,d.jsx)(a.td,{children:"Testes"}),(0,d.jsx)(a.td,{children:(0,d.jsx)(a.a,{href:"https://docs.pytest.org/en/stable/",children:"Pytest"})}),(0,d.jsx)(a.td,{children:"Padr\xe3o da comunidade Python, flex\xedvel e poderoso"})]})]})]}),"\n",(0,d.jsx)(a.h2,{id:"detalhamento-dos-componentes-da-stack",children:"Detalhamento dos Componentes da Stack"}),"\n",(0,d.jsx)(a.h3,{id:"framework-de-api-fastapi",children:"Framework de API: FastAPI"}),"\n",(0,d.jsxs)(a.p,{children:["\u2003 O FastAPI \xe9 a funda\xe7\xe3o de todos os nossos servi\xe7os. Sua alta performance e suporte nativo a opera\xe7\xf5es ass\xedncronas (async/await) s\xe3o essenciais para construir uma plataforma responsiva e escal\xe1vel, capaz de lidar com um grande volume de opera\xe7\xf5es de I/O (consultas a banco de dados, chamadas a APIs externas), em conformidade com nossos requisitos de performance ",(0,d.jsx)(a.code,{children:"(RNF-ED-01)"}),"."]}),"\n",(0,d.jsx)(a.h3,{id:"intera\xe7\xe3o-com-banco-de-dados-sqlalchemy",children:"Intera\xe7\xe3o com Banco de Dados: SQLAlchemy"}),"\n",(0,d.jsxs)(a.p,{children:["\u2003 A comunica\xe7\xe3o com o banco de dados ",(0,d.jsx)(a.code,{children:"PostgreSQL"})," \xe9 abstra\xedda pelo ",(0,d.jsx)(a.code,{children:"SQLAlchemy"}),", o ORM padr\xe3o da comunidade Python. Utilizamos exclusivamente seu motor ass\xedncrono (create_async_engine), que se integra ao FastAPI. As tabelas do banco de dados s\xe3o mapeadas para classes Python (models), o que aumenta a produtividade e a seguran\xe7a do c\xf3digo."]}),"\n",(0,d.jsx)(a.h3,{id:"alida\xe7\xe3o-de-dados-pydantic",children:"alida\xe7\xe3o de Dados: Pydantic"}),"\n",(0,d.jsx)(a.p,{children:"\u2003 O Pydantic \xe9 utilizado para definir schemas de dados claros para todas as opera\xe7\xf5es de API. Adotamos o padr\xe3o de ter schemas espec\xedficos para entrada (Request Models) e sa\xedda (Response Models), o que nos proporciona:"}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Valida\xe7\xe3o Autom\xe1tica:"})," Requisi\xe7\xf5es com dados inv\xe1lidos ou faltando s\xe3o rejeitadas automaticamente pelo framework."]}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Seguran\xe7a:"})," Evita o vazamento acidental de dados internos, expondo apenas os campos definidos no schema de resposta."]}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Documenta\xe7\xe3o Autom\xe1tica:"})," Os schemas Pydantic s\xe3o a fonte da verdade para a gera\xe7\xe3o da documenta\xe7\xe3o OpenAPI."]}),"\n",(0,d.jsx)(a.h3,{id:"migra\xe7\xf5es-de-banco-de-dados-alembic",children:"Migra\xe7\xf5es de Banco de Dados: Alembic"}),"\n",(0,d.jsx)(a.p,{children:"\u2003 Toda altera\xe7\xe3o no schema do banco de dados (modelos do SQLAlchemy) deve ser acompanhada por um script de migra\xe7\xe3o gerado pelo Alembic. Isso garante que a evolu\xe7\xe3o do banco de dados seja controlada, versionada e possa ser aplicada de forma segura e consistente em qualquer ambiente."}),"\n",(0,d.jsx)(a.h3,{id:"autentica\xe7\xe3o-e-autoriza\xe7\xe3o-jwt-oauth2",children:"Autentica\xe7\xe3o e Autoriza\xe7\xe3o: JWT (OAuth2)"}),"\n",(0,d.jsx)(a.p,{children:"\u2003 A seguran\xe7a entre os servi\xe7os \xe9 baseada em JSON Web Tokens. O Servi\xe7o de Contas atua como o provedor de identidade, emitindo um JWT para o usu\xe1rio ap\xf3s um login bem-sucedido. Todas as chamadas subsequentes para qualquer microsservi\xe7o devem conter este token no cabe\xe7alho Authorization. Cada servi\xe7o \xe9 respons\xe1vel por validar a assinatura e as permiss\xf5es do token antes de processar a requisi\xe7\xe3o."}),"\n",(0,d.jsx)(a.h3,{id:"gerenciamento-de-depend\xeancias-poetry",children:"Gerenciamento de Depend\xeancias: Poetry"}),"\n",(0,d.jsxs)(a.p,{children:["\u2003 Poetry \xe9 a ferramenta padr\xe3o para gerenciamento de depend\xeancias e ambientes virtuais em todos os projetos. O uso do ",(0,d.jsx)(a.code,{children:"pyproject.toml"}),"e do poetry.lock garante que todos os ambientes (desenvolvimento, teste, produ\xe7\xe3o) sejam id\xeanticos, eliminando problemas de consist\xeancia."]}),"\n",(0,d.jsx)(a.h3,{id:"testes-pytest",children:"Testes: Pytest"}),"\n",(0,d.jsx)(a.p,{children:"\u2003A qualidade do software \xe9 garantida atrav\xe9s de uma su\xedte de testes automatizados escritos com Pytest. O FastAPI fornece um TestClient que facilita a escrita de testes de integra\xe7\xe3o, permitindo simular requisi\xe7\xf5es \xe0 API sem a necessidade de um servidor em execu\xe7\xe3o."}),"\n",(0,d.jsx)(a.h2,{id:"estrutura-de-diret\xf3rios-padr\xe3o",children:"Estrutura de Diret\xf3rios Padr\xe3o"}),"\n",(0,d.jsx)(a.p,{children:"Para assegurar a consist\xeancia e facilitar a navega\xe7\xe3o entre os projetos, todos os microsservi\xe7os devem seguir a estrutura de diret\xf3rios abaixo:"}),"\n",(0,d.jsx)(a.pre,{children:(0,d.jsx)(a.code,{className:"language-md",children:"/nome-do-servico\n\u251c\u2500\u2500 /alembic/                # Scripts de migra\xe7\xe3o do banco de dados (Alembic)\n\u251c\u2500\u2500 /app/\n\u2502   \u251c\u2500\u2500 /api/                  # Endpoints/Routers da API, camada de entrada de requisi\xe7\xf5es.\n\u2502   \u251c\u2500\u2500 /core/                 # Configura\xe7\xf5es centrais da aplica\xe7\xe3o (ex: settings).\n\u2502   \u251c\u2500\u2500 /crud/                 # Fun\xe7\xf5es de acesso aos dados (l\xf3gica de banco de dados).\n\u2502   \u251c\u2500\u2500 /models/               # Classes que representam as tabelas do banco (SQLAlchemy).\n\u2502   \u251c\u2500\u2500 /schemas/              # Classes de valida\xe7\xe3o de dados da API (Pydantic).\n\u2502   \u2514\u2500\u2500 main.py                # Ponto de entrada da aplica\xe7\xe3o FastAPI.\n\u251c\u2500\u2500 /tests/                    # Testes automatizados (Pytest).\n\u251c\u2500\u2500 pyproject.toml             # Defini\xe7\xe3o do projeto e depend\xeancias (Poetry).\n\u2514\u2500\u2500 poetry.lock                # Arquivo de lock das depend\xeancias.\n\n"})}),"\n",(0,d.jsx)(a.h2,{id:"padr\xf5es-de-comunica\xe7\xe3o-entre-servi\xe7os",children:"Padr\xf5es de Comunica\xe7\xe3o entre Servi\xe7os"}),"\n",(0,d.jsx)(a.p,{children:"\u2003A comunica\xe7\xe3o no ecossistema de microsservi\xe7os do Peerseed segue dois padr\xf5es principais:"}),"\n",(0,d.jsx)(a.h3,{id:"comunica\xe7\xe3o-s\xedncrona-restful-apis",children:"Comunica\xe7\xe3o S\xedncrona (RESTful APIs)"}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Quando usar:"})," Para intera\xe7\xf5es de comando ou consulta que exigem uma resposta imediata."]}),"\n",(0,d.jsxs)(a.blockquote,{children:["\n",(0,d.jsx)(a.p,{children:"Exemplo: O Frontend solicita ao Servi\xe7o de Marketplace a lista de CPRs dispon\xedveis. A requisi\xe7\xe3o precisa ser respondida na hora com os dados."}),"\n"]}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Mecanismo:"})," Chamadas HTTP/S diretas entre os servi\xe7os, geralmente orquestradas atrav\xe9s de um API Gateway, que atua como o ponto de entrada \xfanico para todas as requisi\xe7\xf5es externas."]}),"\n",(0,d.jsx)(a.h3,{id:"comunica\xe7\xe3o-ass\xedncrona-orientada-a-eventos",children:"Comunica\xe7\xe3o Ass\xedncrona (Orientada a Eventos)"}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Quando usar:"})," Para desacoplar os servi\xe7os e para processos que podem ser executados em background, sem que o solicitante precise esperar por uma resposta."]}),"\n",(0,d.jsxs)(a.blockquote,{children:["\n",(0,d.jsx)(a.p,{children:"Exemplo: Quando o Servi\xe7o de Carteira confirma o pagamento de uma parcela, ele publica um evento PagamentoConfirmado. O Servi\xe7o de Notifica\xe7\xf5es e o Servi\xe7o de Distribui\xe7\xe3o escutam este evento e reagem a ele de forma independente, sem que o Servi\xe7o de Carteira precise saber de sua exist\xeancia."}),"\n"]}),"\n",(0,d.jsxs)(a.p,{children:[(0,d.jsx)(a.strong,{children:"Mecanismo:"})," Utiliza\xe7\xe3o de um Message Broker (como RabbitMQ ou AWS SQS), que j\xe1 foi previsto em nossos diagramas de sequ\xeancia."]})]})}function m(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,d.jsx)(a,{...e,children:(0,d.jsx)(l,{...e})}):l(e)}},8453:(e,a,o)=>{o.d(a,{R:()=>t,x:()=>r});var s=o(6540);const d={},n=s.createContext(d);function t(e){const a=s.useContext(n);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),s.createElement(n.Provider,{value:a},e.children)}}}]);